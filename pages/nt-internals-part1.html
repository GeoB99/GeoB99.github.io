<!-- Filename: nt-internals-part1.html -->
<!-- Purpose: "Introduction to the NT kernel development (Part 1)" HTML page -->
<!-- Created by George Bișoc (GeoB99) -->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html lang = "en">
   <head>
      <meta http-equiv = "Content-Type" content = "text/html; charset = UTF-8">
      <title>Introduction to the NT kernel development (Part 1)</title>
      <link href = "../StyleSheet.css" rel = "StyleSheet" type = "text/css">
      <link rel = "icon" href = "../images/ROS.png">
   </head>

   <body>
      <img src = "../images/ROS.png" alt = "ReactOS Icon" align = "left" height = "100" width = "120" hspace = "10">
      <h1>&nbsp;ReactOS Tutorials</h1>
      <h2>&nbsp;Introduction to the NT kernel development (Part 1)</h2>
      <h4>&nbsp;<a href = "../ros-tutorials-home.html"><< Go Back</a></h4>

      <!-- Add a separator -->
      <hr id = "thick">
      <br>

      <!-- Contents table -->
      <h1>&nbsp;<u>Table of Contents</u></h1>
      <ol>
         <li>
            <a href = "#introduction">Introduction</a>
         </li>

         <li>
            <a href = "#tools">Tools needed to get started</a>
         </li>

         <li>
            <a href = "#kernel">What is a kernel?</a>
         </li>

         <li>
            <a href = "#history">Brief history & core keys of the NT kernel</a>
         </li>

         <li>
            <a href = "#foundation">Architecture & Foundation of the NT kernel</a>
         </li>

         <li>
            <a href = "#ntapi">Classification of the NT API</a>
         </li>
      </ol>


      <div id = "kernel">
         <!-- Title -->
         
      </div>

      <!-- Add a separator -->
      <hr>

      <div id = "history">
         <!-- Title -->
         

      <!-- Add a separator -->
      <hr>

      <div id = "foundation">
         <!-- Title -->
         
      <!-- Add a separator -->
      <hr>

      <div id = "ntapi">
         <!-- Title -->
         <h1><u>Classification of the NT API</u></h1>

         <br>

         <!-- Actual content -->
         <p>
            The NT API can be classified into two main parts: <b>executive</b> and <b>kernel</b> APIs. That is, the executive APIs are the libraries from the Executive itself that can be used across kernel mode drivers, other than the kernel itself, and that
            applies the very same thing for the kernel APIs too. The APIs comprehend a variety of functions exported to the public use as well as non-exported ones only used by the kernel. Although the goal of <b>"Introduction to the NT kernel development"</b> is
            to help you dwelling deep onto the kernel and everything that is tied to it, in this section of the article we're going to take a glimpse at the exported functions only, categorised in specific labels.
         </p>

         <p>
            It is also important to take into consideration that many functions, even if not exported, are private which cannot be called outside of other components in the NT kernel even. Although this is something that I'll be going to explain that thoroughly in
            the "topology of function prefixes" later.
         </p>

         <h3>&nbsp;&#129154; Configuration Manager APIs</h3>
         <p>
            <b>1. Callback calls</b> -- CmRegisterCallback, CmRegisterCallbackEx, CmUnRegisterCallback, CmGetCallbackVersion, CmSetCallbackObjectContext, et al.
            <br>
            <b>2. Transaction calls</b> -- CmGetBoundTransaction, et al.
         </p>

         <h3>&nbsp;&#129154; Cache Manager APIs</h3>
         <p>
            <b>1. Copy/Read calls</b> -- CcCanIWrite, CcFastCopyRead, CcFastCopyWrite, CcCopyRead, CcCopyWrite, CcDeferWrite, et al.
            <br>
            <b>2. Write preparation calls</b> -- CcMdlWriteComplete, CcPrepareMdlWrite, CcPreparePinWrite, et al.
            <br>
            <b>3. Cache mapping initialisation calls</b> -- CcUninitializeCacheMap, CcInitializeCacheMap, et al.
            <br>
            <b>4. Pinning calls</b> -- CcPinMappedData, CcPinRead, CcRepinBcb, CcUnpinData, CcUnpinDataForThread, CcUnpinRepinnedBcb, et al.
         </p>

         <h3>&nbsp;&#129154; I/O Manager APIs</h3>
         <p>
            <b>1. Events calls</b> -- IoCreateNotificationEvent, IoCreateSynchronizationEvent, et al.
            <br>
            <b>2. I/O Timers calls</b> -- IoInitializeTimer, IoStartTimer, IoStopTimer, et al.
            <br>
            <b>3. IRPs manipulation calls</b> -- IoAllocateIrp, IoCancelThreadIo, IoForwardIrpSynchronously, IoGetPagingIoPriority, IoGetTopLevelIrp, IoInitializeIrp, et al.
            <br>
            <b>4. Volume support calls</b> -- IoUnregisterFileSystem, IoRegisterFsRegistrationChange, IoVolumeDeviceToDosName, et al.
            <br>
            <b>5. Symbolic links calls</b> -- IoCreateSymbolicLink, IoCreateUnprotectedSymbolicLink, IoDeleteSymbolicLink, et al.
            <br>
            <b>6. Remove locks (REM) support calls</b> -- IoInitializeRemoveLockEx, IoAcquireRemoveLockEx, IoReleaseRemoveLockEx, IoReleaseRemoveLockAndWaitEx, et al.
            <br>
            <b>7. Interrupt requests (IRQ) calls</b> -- IoConnectInterrupt, IoDisconnectInterrupt, et al.
         </p>

         <h3>&nbsp;&#129154; Process Structure APIs</h3>
         <p>
            <b>1. Query/Set process and threads information calls</b> -- NtQueryInformationProcess, NtSetInformationThread, NtQueryInformationThread, NtSetInformationProcess, et al.
            <br>
            <b>2. Pool Quota management calls</b> -- PsChargeProcessPageFileQuota, PsChargePoolQuota, PsChargeProcessNonPagedPoolQuota, PsReturnPoolQuota, et al.
            <br>
            <b>3. Security process calls</b> -- NtOpenProcessToken, NtOpenProcessTokenEx, PsReferencePrimaryToken, PsOpenTokenOfProcess, PsRevertThreadToSelf, PsImpersonateClient, et al.
            <br>
            <b>4. Thread/Process kill calls</b> -- PsTerminateSystemThread, NtTerminateProcess, NtTerminateThread, NtRegisterThreadTerminatePort, et al.
            <br>
            <b>5. Process notification calls</b> -- PsSetCreateProcessNotifyRoutine, PsSetLegoNotifyRoutine, PsRemoveLoadImageNotifyRoutine, et al.
         </p>

         <h3>&nbsp;&#129154; Security Reference Monitoring APIs</h3>
         <p>
            <b>1. Access tokens calls</b> -- NtOpenThreadToken, NtCompareTokens, NtFilterToken, NtImpersonateAnonymousToken, SeIsTokenChild, SeSubProcessToken, et al.
            <br>
            <b>2. Access & check calls</b> -- SeCaptureSubjectContext, SeLockSubjectContext, SeCreateAccessStateEx, SeAccessCheck, SeFastTraverseCheck, et al.
            <br>
            <b>3. Auditing calls</b> -- SeDetailedAuditingWithToken, SeAuditProcessCreate, SeInitializeProcessAuditName, et al.
            <br>
            <b>4. Privileges handling calls</b> -- SePrivilegePolicyCheck, SeCheckAuditPrivilege, SeCaptureLuidAndAttributesArray, SeAppendPrivileges, et al.
         </p>

         <h3>&nbsp;&#129154; Power Manager APIs</h3>
         <p>
            <b>1. Shutdown procedure calls</b> -- PoRequestShutdownWait, PoQueueShutdownWorkItem, PoRequestShutdownEvent, NtInitiatePowerAction, et al.
            <br>
            <b>2. Power events suppor calls</b> -- PoNotifySystemTimeSet, et al.
            <br>
            <b>3. Volume handling calls</b> -- PoRemoveVolumeDevice, PoInitializeDeviceObject, et al.
         </p>

         <h3>&nbsp;&#129154; Executive APIs</h3>
         <p>
            <b>1. Executive callbacks calls</b> -- ExInitializeCallBack, ExAllocateCallBack, ExNotifyCallback, ExRegisterCallback, ExCompareExchangeCallBack, et al.
            <br>
            <b>2. Fast mutex calls</b> -- ExAcquireFastMutexUnsafe, ExReleaseFastMutexUnsafe, ExEnterCriticalRegionAndAcquireFastMutexUnsafe, ExReleaseFastMutexUnsafeAndLeaveCriticalRegion, et al.
            <br>
            <b>3. Mutant calls</b> -- NtCreateMutant, NtOpenMutant, NtQueryMutant, NtReleaseMutant, et al.
            <br>
            <b>4. Rundown Protection calls</b> -- ExfAcquireRundownProtection, ExfInitializeRundownProtection, ExfWaitForRundownProtectionRelease, ExfAcquireRundownProtectionCacheAware, et al.
            <br>
            <b>5. Timers calls</b> -- ExTimerRundown, NtOpenTimer, NtQueryTimer, NtSetTimer, et al.
            <br>
            <b>6. Locale support calls</b> -- NtSetDefaultLocale, NtQueryDefaultLocale, NtQueryInstallUILanguage, NtQueryDefaultUILanguage, et al.
            <br>
            <b>7. Resource calls</b> -- ExReleaseResourceLock, ExAcquireResourceLock, ExDeleteResourceLite, ExGetSharedWaiterCount, ExInitializeResourceLite, et al.
            <br>
            <b>8. Pushlock calls</b> -- ExfAcquirePushLockShared, ExfReleasePushLock, ExfReleasePushLockShared, ExfReleasePushLockExclusive, et al.
            <br>
            <b>9. Look-Aside List calls</b> -- ExInitializeSystemLookasideList, ExDeletePagedLookasideList, ExInitializeNPagedLookasideList, ExInitializePagedLookasideList, et al.
         </p>

         <h3>&nbsp;&#129154; Object Manager APIs</h3>
         <p>
            <b>1. Object handle opening/insertion calls</b> -- ObOpenObjectByName, ObOpenObjectByPointer, ObFindHandleForObject, ObInsertObject, ObSetHandleAttributes, et al.
            <br>
            <b>2. Object life monitoring calls</b> -- ObQueryTypeInfo, ObCreateObject, ObCreateObjectType, ObDeleteCapturedInsertInfo, NtMakeTemporaryObject, NtSetInformationObject, et al.
            <br>
            <b>3. Referencing/Dereferencing object calls</b> -- ObReferenceObjectSafe, ObFastReferenceObject, ObFastReplaceObject, ObReferenceFileObjectForWrite, ObfDereferenceObject, et all.
            <br>
            <b>4. Waiting calls</b> -- NtWaitForMultipleObjects, NtWaitForMultipleObjects32, NtWaitForSingleObject, NtSignalAndWaitForSingleObject, et al.
            <br>
            <b>5. Symbolic link object calls</b> -- NtCreateSymbolicLinkObject, NtOpenSymbolicLinkObject, NtQuerySymbolicLinkObject, et al.
         </p>

         <h3>&nbsp;&#129154; Memory Manager APIs</h3>
         <p>
            <b>1. Pool allocation calls</b> -- ExAllocatePoolWithTag, ExAllocatePool, ExFreePoolWithTag, ExFreePool, ExAllocatePoolWithTagPriority, et al.
            <br>
            <b>2. Dynamic memory manipulation support calls</b> -- MmAddPhysicalMemory, MmMarkPhysicalMemoryAsBad, MmMarkPhysicalMemoryAsGood, MmRemovePhysicalMemory, MmGetPhysicalMemoryRanges, et al.
            <br>
            <b>3. Driver management calls</b> -- MmUnlockPageableImageSection, MmLockPageableSectionByHandle, MmTrimAllSystemPageableMemory, MmAddVerifierThunks, MmIsDriverVerifying, MmIsVerifierEnabled, et al.
            <br>
            <b>4. I/O Mapping calls</b> -- MmMapIoSpace, MmUnmapIoSpace, MmMapVideoDisplay, MmUnmapVideoDisplay, MmIsIoSpaceActive, et al.
            <br>
            <b>5. MDL support calls</b> -- MmAllocatePagesForMdl, MmAllocatePagesForMdlEx, MmFreePagesFromMdl, MmMapLockedPagesSpecifyCache, MmMapLockedPages, et al.
            <br>
            <b>6. Page faulting calls</b> -- MmSetExecuteOptions, MmGetExecuteOptions, MmAccessFault, et al.
            <br>
            <b>7. Sections support calls</b> -- MmMapViewOfSection, MmDisableModifiedWriteOfSection, MmForceSectionClosed, MmMapViewInSessionSpace, MmUnmapViewInSessionSpace, et al.
            <br>
            <b>8. Virtual memory calls</b> -- MmCopyVirtualMemory, MmFlushVirtualMemory, NtFlushVirtualMemory, NtGetWriteWatch, et al.
         </p>

         <h3>&nbsp;&#129154; Kernel APIs</h3>
         <p>
            <b>1. APC calls</b> -- KeEnterCriticalRegion, KeLeaveCriticalRegion, KeInitializeApc, KeInsertQueueApc, et al.
            <br>
            <b>2. Balance Manager</b> -- KeBalanceSetManager, et al.
            <br>
            <b>3. DPC support calls</b> -- KeInitializeThreadedDpc, KeInitializeDpc, KeInsertQueueDpc, KeFlushQueuedDpcs, et al.
            <br>
            <b>4. Event Dispatcher calls</b> -- KeClearEvent, KeInitializeEvent, KePulseEvent, KeReadStateEvent, KeResetEvent, KeSetEventBoostPriority, et al.
            <br>
            <b>5. Exception handling calls</b> -- NtRaiseException, NtContinue, et al.
            <br>
            <b>6. Gate Dispatcher calls</b> -- KeInitializeGate, KeWaitForGate, KeSignalGateBoostPriority, et al.
            <br>
            <b>7. Mutant Dispatcher calls</b> -- KeInitializeMutant, KeInitializeMutex, KeReleaseMutant, KeReadStateMutant, et al.
            <br>
            <b>8. Kernel process management calls</b> -- KeSetProcess, KeInitializeProcess, KeSetQuantumProcess, KeSetAffinityProcess, KeSetAutoAlignmentProcess, KeSetPriorityAndQuantumProcess, et al.
            <br>
            <b>9. Kernel profiling calls</b> -- KeInitializeProfile, KeStartProfile, KeStopProfile, KeQueryIntervalProfile, et al.
            <br>
            <b>10. Kernel thread objects calls</b> -- KeReadyThread, KeAlertThread, KeBoostPriorityThread, KeForceResumeThread, KeFreezeAllThreads, KeRundownThread, et al.
            <br>
            <b>11. Semaphore Dispatcher calls</b> -- KeInitializeSemaphore, KeReadStateSemaphore, KeReleaseSemaphore, et al.
            <br>
            <b>12. Kernel queue calls</b> -- KeInitializeQueue, KeInsertHeadQueue, KeReadStateQueue, KeRemoveQueue, KeRundownQueue, et al.
            <br>
            <b>13. Kernel device queue calls</b> -- KeInitializeDeviceQueue, KeInsertDeviceQueue, KeInsertByKeyDeviceQueue, KeRemoveDeviceQueue, KeRemoveEntryDeviceQueue, et al.
            <br>
            <b>14. Clock support calls</b> -- KeSetSystemTime, KeQueryTimeIncrement, KeQueryTickCount, KeQuerySystemTime, KeQueryInterruptTime, et al.
            <br>
            <b>15. Bugcheck (Blue Screen of Death) mechanism calls</b> -- KeGetBugMessageText, KeInitializeCrashDumpHeader, KeDeregisterBugCheckCallback, KeDeregisterBugCheckReasonCallback, KeBugCheckEx, KeBugCheck, KeEnterKernelDebugger, et al.
         </p>
      </div>
   </body>
</html>
